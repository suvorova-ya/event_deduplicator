–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ –±–∞–∑–µ FastAPI + Kafka + Redis + PostgreSQL + Bloom Filter –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö (>1000 RPS).


---

##  –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **FastAPI** ‚Äî –ø—Ä–∏–µ–º —Å–æ–±—ã—Ç–∏–π POST /event, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Kafka
- **Kafka** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–±—ã—Ç–∏–π 
- **Consumer** ‚Äî —á—Ç–µ–Ω–∏–µ –∏–∑ Kafka, –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- **Redis** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ö–µ—à–µ–π —Å TTL
- **Redis Bloom Filter** ‚Äî –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏
- **PostgreSQL** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **Prometheus + Grafana** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---



–¢–µ—Å—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ (Locust)


![tab=stats.png](img/tab=stats.png)
![total_requests_per_second_1755597438.636.png](img/total_requests_per_second_1755597438.636.png)


___
–ò—Ç–æ–≥:  

‚úÖ FastAPI-—Å–µ—Ä–≤–∏—Å —Å–ø—Ä–∞–≤–∏–ª—Å—è —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π ~1000 RPS

‚úÖ –ù–µ—Ç –ø–∞–¥–µ–Ω–∏–π, –æ—à–∏–±–æ–∫ –∏–ª–∏ —Ä–µ–∑–∫–∏—Ö –ø—Ä–æ–≤–∞–ª–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞

‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –≤ Grafana –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è.

‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ Kafka + Redis —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

___

![img.png](img/img.png)
üíæ save_db:
6397 –æ–ø–µ—Ä–∞—Ü–∏–π, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è ‚Äî 0.010 —Å–µ–∫

‚è±Ô∏è check_redis:
7905 –æ–ø–µ—Ä–∞—Ü–∏–π, —Å—Ä–µ–¥–Ω–µ–µ ‚Äî 0.003 —Å–µ–∫

üîç check_bloom:
6396 –æ–ø–µ—Ä–∞—Ü–∏–π, —Å—Ä–µ–¥–Ω–µ–µ ‚Äî 0.005 —Å–µ–∫

---

## ‚ö° –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å 

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash

git clone https://github.com/suvorova-ya/event_deduplicator.git
cd event_deduplicator


```
### –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
```bash

docker-compose up --build

```

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ (–∫–æ–Ω—Å—å—é–º–µ—Ä–æ–≤)

```bash

docker compose up -d --scale deduplicator-worker=5

```

- FastAPI API: http://localhost:8000/docs
- Grafana: http://localhost:3000/
- Prometheus: http://localhost:9090/
- Locust : http://localhost:8089/

---





## üí¨ –ê–≤—Ç–æ—Ä
–°–æ–∑–¥–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏.
